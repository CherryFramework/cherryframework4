!function(e){"use strict";CHERRY_API.utilites.namespace("ui_elements.typography"),CHERRY_API.ui_elements.typography={init:function(e){var t=this;CHERRY_API.status.document_ready?t.render(e):CHERRY_API.variable.$document.on("ready",t.render(e))},render:function(t){function a(t,a){var n=e(t).parents(".cherry-ui-typography-wrap:first"),c=e(".cherry-font-preview",n),i=e("select.cherry-font-family",n).val(),s=e(".cherry-font-style",n).val(),l=(e(".cherry-font-character",n).val(),e(".font-size .cherry-ui-stepper-input",n).val()),f=e(".font-lineheight .cherry-ui-stepper-input",n).val(),h=e(".font-letterspacing .cherry-ui-stepper-input",n).val(),y=e(".cherry-text-align",n).val(),p=e(".cherry-color-picker",n).val(),u=e(".font-type",n).val();"web"==u&&a&&r(t),c.css({display:"block"}),c.css({"font-family":i+", sans-serif"}),-1!==s.indexOf("italic")?(c.css({"font-style":"italic"}),s=s.replace("italic","")):c.css({"font-style":"normal"}),c.css({"font-weight":s}),c.css({"font-size":l+"px"}),c.css({"line-height":f+"px"}),c.css({"letter-spacing":h+"px"}),c.css({"text-align":y}),c.css({color:p}),c.css({"background-color":o(p)})}function r(t){var a=e(t).parents(".cherry-ui-typography-wrap:first"),r=e(".cherry-font-family",a).val(),n=e(".cherry-font-style",a).val(),c=e(".cherry-font-character",a).val(),i={family:r,style:n,character:c};l(i,a)}function n(t){var a=t.parents(".cherry-ui-typography-wrap"),r=e(".cherry-font-family",a),n=r.val();f(a,n)}function c(t){var a=t.parents(".cherry-ui-typography-wrap"),r=e(".cherry-font-family",a),n=r.val();h(a,n)}function i(t){var a=t.parents(".cherry-ui-typography-wrap"),r=t.find(":selected"),n=e(".cherry-font-category",a),c=s(t);e(".font-type",a).val(c),n.val(r.data("category")),"web"==c?e(".field-font-character",_).css({display:"block"}):e(".field-font-character",_).css({display:"none"})}function s(e){var t=e.find(":selected"),a=t.parents("optgroup:first");return a.data("font-type")}function o(e){var t="#222222";if(""!==e){e=e.replace("#","");var a=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),n=parseInt(e.substr(4,2),16),c=(299*a+587*r+114*n)/1e3;t=c>=128?"#222222":"#ffffff"}return t}function l(t,a){var r={action:"get_google_font_link",font_data:t},n=(e(".cherry-font-preview",a),t.family.replace(" ","-")+t.style+t.character+".css");p=e.ajax({type:"POST",url:ajaxurl,data:r,cache:!1,beforeSend:function(){m=!1},success:function(t){m=!0,-1==e.inArray(n,CHERRY_API.variable.loaded_assets.style)&&(CHERRY_API.variable.loaded_assets.style.push(n),e("head").append(e("<link rel='stylesheet' href='"+t+"' type='text/css' media='all'>")))},dataType:"html"})}function f(t){var a=e("select.cherry-font-family",t),r=e(".field-font-style",t),n=a.val(),c=t.data("id"),i=t.data("name"),s={action:"get_fonts_variants",font:n,id:c,name:i};null==u||v||u.abort(),u=e.ajax({type:"POST",url:ajaxurl,data:s,cache:!1,beforeSend:function(){v=!1,r.fadeTo(100,.3)},success:function(e){v=!0,r.fadeTo(100,1),r.html(e),CHERRY_API.ui_elements.select.init(r)},dataType:"html"})}function h(t){var a=e("select.cherry-font-family",t),r=e(".field-font-character",t),n=a.val(),c=t.data("id"),i=t.data("name"),s={action:"get_fonts_subsets",font:n,id:c,name:i};null==d||g||d.abort(),d=e.ajax({type:"POST",url:ajaxurl,data:s,cache:!1,beforeSend:function(){g=!1,r.fadeTo(100,.3)},success:function(e){g=!0,r.fadeTo(100,1),r.html(e),CHERRY_API.ui_elements.select.init(r)},dataType:"html"})}var y=e(".cherry-ui-typography-wrap",t),p=null,u=null,d=null,p=null,v=!0,g=!0,m=!0;0!==y.length&&(e(".cherry-font-family",y).each(function(){a(e(this),!0)}),e(".cherry-font-family",y).on("change",function(){i(e(this)),a(e(this),!0),n(e(this)),c(e(this))}),e(y).on("change",".cherry-font-style",function(){a(e(this),!0)}),e(".cherry-font-character",y).on("change",function(){}),e(".font-size .cherry-ui-stepper-input",y).on("change",function(){a(e(this),!1)}),e(".font-lineheight .cherry-ui-stepper-input",y).on("change",function(){a(e(this),!1)}),e(".font-letterspacing .cherry-ui-stepper-input",y).on("change",function(){a(e(this),!1)}),e(".cherry-text-align",y).on("change",function(){a(e(this),!1)}),e(".cherry-color-picker",y).wpColorPicker({change:function(){a(e(this),!1)}}));var _=0}}}(jQuery);