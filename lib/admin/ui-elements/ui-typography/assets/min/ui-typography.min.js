!function(e){"use strict";CHERRY_API.utilites.namespace("ui_elements.typography"),CHERRY_API.ui_elements.typography={init:function(e){var t=this;CHERRY_API.status.document_ready?t.render(e):CHERRY_API.variable.$document.on("ready",t.render(e))},render:function(t){function n(t,n){var a=e(t).parents(".cherry-ui-typography-wrap:first"),c=e(".cherry-font-preview",a),i=e("select.cherry-font-family",a).val(),s=e(".cherry-font-style",a).val(),l=(e(".cherry-font-character",a).val(),e(".font-size .cherry-ui-stepper-input",a).val()),f=e(".font-lineheight .cherry-ui-stepper-input",a).val(),y=e(".font-letterspacing .cherry-ui-stepper-input",a).val(),h=e(".cherry-text-align",a).val(),p=e(".cherry-color-picker",a).val();"web"==e(".font-type",a).val()&&n&&r(t),c.css({display:"block"}),c.css({"font-family":i+", sans-serif"}),-1!==s.indexOf("italic")?(c.css({"font-style":"italic"}),s=s.replace("italic","")):c.css({"font-style":"normal"}),c.css({"font-weight":s}),c.css({"font-size":l+"px"}),c.css({"line-height":f+"px"}),c.css({"letter-spacing":y+"px"}),c.css({"text-align":h}),c.css({color:p}),c.css({"background-color":o(p)})}function r(t){var n=e(t).parents(".cherry-ui-typography-wrap:first");l({family:e(".cherry-font-family",n).val(),style:e(".cherry-font-style",n).val(),character:e(".cherry-font-character",n).val()},n)}function a(t){var n=t.parents(".cherry-ui-typography-wrap");e(".cherry-font-family",n).val();f(n)}function c(t){var n=t.parents(".cherry-ui-typography-wrap");e(".cherry-font-family",n).val();y(n)}function i(t){var n=t.parents(".cherry-ui-typography-wrap"),r=t.find(":selected"),a=e(".cherry-font-category",n),c=s(t);e(".font-type",n).val(c),a.val(r.data("category")),"web"==c?e(".field-font-character",_).css({display:"block"}):e(".field-font-character",_).css({display:"none"})}function s(e){return e.find(":selected").parents("optgroup:first").data("font-type")}function o(e){var t="#222222";return""!==e&&(e=e.replace("#",""),t=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"#222222":"#ffffff"),t}function l(t,n){var r={action:"get_google_font_link",font_data:t},a=(e(".cherry-font-preview",n),t.family.replace(" ","-")+t.style+t.character+".css");p=e.ajax({type:"POST",url:ajaxurl,data:r,cache:!1,beforeSend:function(){m=!1},success:function(t){m=!0,-1==e.inArray(a,CHERRY_API.variable.loaded_assets.style)&&(CHERRY_API.variable.loaded_assets.style.push(a),e("head").append(e("<link rel='stylesheet' href='"+t+"' type='text/css' media='all'>")))},dataType:"html"})}function f(t){var n=e("select.cherry-font-family",t),r=e(".field-font-style",t),a={action:"get_fonts_variants",font:n.val(),id:t.data("id"),name:t.data("name")};null==u||g||u.abort(),u=e.ajax({type:"POST",url:ajaxurl,data:a,cache:!1,beforeSend:function(){g=!1,r.fadeTo(100,.3)},success:function(e){g=!0,r.fadeTo(100,1),r.html(e),CHERRY_API.ui_elements.select.init(r)},dataType:"html"})}function y(t){var n=e("select.cherry-font-family",t),r=e(".field-font-character",t),a={action:"get_fonts_subsets",font:n.val(),id:t.data("id"),name:t.data("name")};null==d||v||d.abort(),d=e.ajax({type:"POST",url:ajaxurl,data:a,cache:!1,beforeSend:function(){v=!1,r.fadeTo(100,.3)},success:function(e){v=!0,r.fadeTo(100,1),r.html(e),CHERRY_API.ui_elements.select.init(r)},dataType:"html"})}var h=e(".cherry-ui-typography-wrap",t),p=null,u=null,d=null,p=null,g=!0,v=!0,m=!0;0!==h.length&&(e(".cherry-font-family",h).each(function(){n(e(this),!0)}),e(".cherry-font-family",h).on("change",function(){i(e(this)),n(e(this),!0),a(e(this)),c(e(this))}),e(h).on("change",".cherry-font-style",function(){n(e(this),!0)}),e(".cherry-font-character",h).on("change",function(){}),e(".font-size .cherry-ui-stepper-input",h).on("change",function(){n(e(this),!1)}),e(".font-lineheight .cherry-ui-stepper-input",h).on("change",function(){n(e(this),!1)}),e(".font-letterspacing .cherry-ui-stepper-input",h).on("change",function(){n(e(this),!1)}),e(".cherry-text-align",h).on("change",function(){n(e(this),!1)}),e(".cherry-color-picker",h).wpColorPicker({change:function(t,r){n(e(this),!1)}}));var _=0}},e(window).on("cherry-ui-elements-init",function(e,t){CHERRY_API.ui_elements.typography.init(t.target)})}(jQuery);