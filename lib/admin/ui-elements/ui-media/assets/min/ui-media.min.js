!function(e){"use strict";CHERRY_API.utilites.namespace("ui_elements.media"),CHERRY_API.ui_elements.media={init:function(e){var a=this;CHERRY_API.status.document_ready?a.render(e):CHERRY_API.variable.$document.on("ready",a.render(e))},render:function(a){e(".upload-button",a).on("click",function(){var a,i=e(this).parents(".cherry-ui-media-wrap"),t=e(".cherry-upload-input",i),s=e(".cherry-upload-preview",i),c=e(this).data("title"),n=e(this).data("multi-upload"),l=e(this).data("library-type");return a=wp.media.frames.file_frame=wp.media({title:c,button:{text:c},multiple:n,library:{type:l}}),a.on("select",function(){var i=a.state().get("selection").toJSON(),c=0,l="",o="",d="";for(n&&(l=t.val(),d=",",o=e(".cherry-all-images-wrap",s).html());i[c];){var u=i[c],p=u.id,m=u.mime,h="",v="";switch(m){case"image/jpeg":case"image/png":case"image/gif":void 0!=u.sizes&&(h=u.sizes.thumbnail?u.sizes.thumbnail.url:u.sizes.full.url),v='<img  src="'+h+'" alt="" data-img-attr="'+p+'">';break;case"image/x-icon":v='<span class="dashicons dashicons-format-image"></span>';break;case"video/mpeg":case"video/mp4":case"video/quicktime":case"video/webm":case"video/ogg":v='<span class="dashicons dashicons-format-video"></span>';break;case"audio/mpeg":case"audio/wav":case"audio/ogg":v='<span class="dashicons dashicons-format-audio"></span>'}o+='<div class="cherry-image-wrap"><div class="inner"><div class="preview-holder"  data-id-attr="'+p+'"><div class="centered">'+v+'</div></div><a class="cherry-remove-image" href="#"><i class="dashicons dashicons-no"></i></a><span class="title">'+u.title+"</span></div></div>",l+=d+p,c++}t.val(l.replace(/(^,)/,"")),e(".cherry-all-images-wrap",s).html(o),e(".cherry-remove-image").on("click",function(){return r(e(this)),!1})}).open(),!1}),jQuery(".cherry-remove-image",a).on("click",function(){return r(jQuery(this)),!1});var r=function(e){var a=e.parents(".cherry-ui-media-wrap"),r=jQuery(".cherry-upload-input",a),i=e.parent().parent(".cherry-image-wrap"),t=jQuery(".preview-holder",i).data("id-attr"),s=r.attr("value"),c=new RegExp(""+t+"(,*)","i");s=s.replace(c,""),s=s.replace(/(,$)/,""),r.attr({value:s}),i.remove()};jQuery(".cherry-all-images-wrap",a).sortable({items:"div.cherry-image-wrap",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"cherry-media-thumb-sortable-placeholder",start:function(){},stop:function(){},update:function(){var e="";jQuery(".cherry-image-wrap",this).each(function(){var a=jQuery(".preview-holder",this).data("id-attr");e=e+a+","}),e=e.substr(0,e.lastIndexOf(",")),jQuery(this).parent().siblings(".cherry-element-wrap").find("input.cherry-upload-input").val(e)}})}}}(jQuery);